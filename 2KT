<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified">

  <xs:complexType name='OfficesType'>
    <xs:sequence>
      <xs:element name='office' minOccurs='1' maxOccurs="unbounded">
        <xs:complexType>
          <xs:simpleContent>
            <xs:extension base='xs:string'>
              <xs:attribute name='code' type='xs:ID' use="required"/>
            </xs:extension>
          </xs:simpleContent>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name='NotebookType'>
    <xs:sequence>
      <xs:element name='offices' type='OfficesType' minOccurs='1' maxOccurs='1'/>
      <xs:element name='person' type='PersonType' minOccurs='1' maxOccurs='unbounded'/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="PhoneType">
    <xs:simpleContent>
      <xs:extension base="NumType">
        <xs:attribute name="type" use="optional">
          <xs:simpleType>
            <xs:restriction base="xs:string">
              <xs:enumeration value="work"/>
              <xs:enumeration value="home"/>
            </xs:restriction>
          </xs:simpleType>
        </xs:attribute>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  
  <xs:simpleType name="NumType">
   <xs:restriction base="xs:string">
      <xs:pattern value="\d{3}-\d{2}-\d{2}"/>
   </xs:restriction> 
  </xs:simpleType>

  <xs:complexType name='PhonesType'>
    <xs:sequence>
      <xs:element name='phone' type='PhoneType' minOccurs='1' maxOccurs='unbounded'/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name='NameType'>
    <xs:sequence>
      <xs:element name='first' type='xs:string' minOccurs='1' maxOccurs='1'/>
      <xs:element name='surname' type='xs:string' minOccurs='1' maxOccurs='1'/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name='AddressType'>
    <xs:all>
      <xs:element name='city' type='xs:string' minOccurs='1' maxOccurs='1'/>
      <xs:element name='street' type='xs:string' minOccurs='1' maxOccurs='1'/>
      <xs:element name='index' minOccurs="1" maxOccurs="1">
        <xs:simpleType>
          <xs:restriction base='xs:string'>
            <xs:pattern value='[0-9]{6}'/>
          </xs:restriction>
        </xs:simpleType>
      </xs:element>
    </xs:all>
  </xs:complexType>

  <xs:complexType name='PersonType'>
    <xs:sequence>
      <xs:element name='name' type='NameType' minOccurs='1' maxOccurs='1'/>
      <xs:element name='address' type='AddressType' minOccurs='1' maxOccurs='1'/>
      <xs:element name='phones' type='PhonesType' minOccurs='1' maxOccurs='1'/>
    </xs:sequence>
    <xs:attribute name="id" type="xs:ID" use="required"/>
    <xs:attribute name="office" type="xs:IDREF" use="required"/>
  </xs:complexType>

  <xs:element name='notebook' type='NotebookType'/>

</xs:schema>
